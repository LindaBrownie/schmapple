<!DOCTYPE HTML>
<html lang="en-US">
	<head>
		<meta charset="UTF-8">
		<title>template for simple games</title>
		<script type="text/javascript" src = "./js/simple_game.js"></script>
		<script type="text/javascript" src = "./js/simple_game_extension.js"></script>
		<script type="text/javascript" src = "./js/basket_game.js"></script>
		<script type="text/javascript">
			var scene;
			var fallingObject;
			var basket;
			var accel;
			var window_orientation = 90;
			var previousKeyLeft = false;
			var accelerometer;
			var launchTimer = 0;
			
			// spawn a new object every 1500ms
			var spawnRate = 700;
			// set how fast the objects will fall
			var spawnRateOfDescent = 2.00;
			// when was the last object spawned
			var lastSpawn = -1;
			// this array holds all spawned object
			var objects = [];
			// save the starting time (used to calc elapsed time)
			var startTime = Date.now();
			
			window.addEventListener("orientationchange", function() {
				window_orientation = window.orientation;

				var newWidth = window.innerWidth-50;
				var newHeight = window.innerHeight-50;

				if(newWidth > 800)
					newWidth = 800;
				if(newHeight > 600)
					newHeight = 600;

				if(scene){
					scene.setSize(newWidth, newHeight);
				}

			}, false);
			
			function init(){
				scene = new Scene();
				//loop and random number
				fallingObject = new FallingObject(scene);
				basket = new Basket(scene);
				
				scene.start();

				basket.init();
				fallingObject.init();
			} // end init
			
			function update(){
				scene.clear();

				//handle events here
				basket.checkKeys();
				
				/*if(basket.collidesWith(fallingObject)){
					fallingObject.setPosition(Math.random() * 600, -200);
				}*/
				/*if(launchTimer === 80){
				  fallingObject.launchOne();
				  launchTimer = 0;
				}*/
				// get the elapsed time
				var time = Date.now();

				// see if its time to spawn a new object
				if (time > (lastSpawn + spawnRate) && objects.length < 15) {
					lastSpawn = time;
					spawnRandomObject();
				}
				
				for (var i = 0; i < objects.length; i++) {
					var object = objects[i];
					
					object.update();
					//object.y += spawnRateOfDescent;
				}
				
				//update all the sprites
				//fallingObject.update(scene);
				basket.update();
				launchTimer++;
			}
			
			function spawnRandomObject() {
				// select a random type for this new object
				//var t;

				// About Math.random()
				// Math.random() generates a semi-random number
				// between 0-1. So to randomly decide if the next object
				// will be A or B, we say if the random# is 0-.49 we
				// create A and if the random# is .50-1.00 we create B

				/*if (Math.random() < 0.50) {
					t = "red";
				} else {
					t = "blue";
				}*/

				// create the new object
				/*var object = {
					// set this objects type
					type: t,
					// set x randomly but at least 15px off the canvas edges
					x: Math.random() * (canvas.width - 30) + 15,
					// set y to start on the line where objects are spawned
					y: spawnLineY,
				}*/

				fallingObject = new FallingObject(scene);
				fallingObject.init();
				// add the new object to the objects[] array
				objects.push(fallingObject);
			}
		</script>
	</head>
	<body onload = "init()">
		
	</body>
</html>